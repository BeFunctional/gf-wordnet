<!DOCTYPE html>
<html>
	<head>
		<title>GF WordNet</title>
		<style>
			body {
				color: black;
				background: #eee;
			}

			@media (min-resolution: 300dpi) {
				body {
					font-size: 200%;
  				}
				select, input, button, table.multiselect {
					font-size: 140%;
  				}
			}

			img {
				width: 0.7em;
			}

			table.result {
				border-collapse: collapse;
				border: 2px solid #66c;
				max-width: 100%;
				position: relative;
				z-index: 0;
			}
			td.details > div > table.result {
				margin: 5px;
			}
			table.result > tr > th {
				text-align: center;
				color: #008;
				border: 2px solid #66c;
				background: #99e;
			}
			table.result > tr > td {
				border: 1px solid #66c;
				background: #bdf;
				padding: 3px;
			}
			table.result > tr > td[colspan] {
				border-width: 2px 2px 1px 2px ;
				background: #cef;
			}
			table.result > tr > td.selected {
				background: white;
				border-bottom-style: none;
			}
			table.result > tr > td.unselected {
				border-bottom-style: none;
			}
			table.result > tr > td.details {
				background: white;
				border-top-style: none;
			}
			table.result > tr > td.details > div {
				min-height: 100px;
				max-height: 500px;
				overflow: auto;
			}
			.bar {
				background: #ABABAB;
				width: 5px;
				height: 15px;
				display: inline-block;
				margin: 1px;
			}

			.unchecked {
				text-decoration: underline dotted red;
			}

			table.header-tabs {
				width: 100%
			}

			table.header-tabs > tr > td:nth-last-child(2) {
				width: 100%;
			}

			table.header-tabs > tr > td > input {
				float: right;
			}

			table.header-tabs > tr > td {
				padding-left: 10px;
				padding-right: 10px;
			}

			table.header-tabs > tr > td > h1 {
				cursor: pointer;
			}
			
			h1.unselected {
				color: #DFDFDF;
				font-weight: normal;
			}
			
			div.popup {
				top: 0em;
				left: 0em;
				right: 0em;
				bottom: 0em;
				margin: 2em;
				border: 1px solid #ccc;
				background-color: #f3f3f3;
				position: fixed;
				min-width: 790px;
				overflow: auto;
				z-index: 100;
			}

			div.popup > table > tr > td > img {
				display: block;
				float: right;
				padding: 4px;
			}
			
			span.selected_bracket {
				background-color: #99e;
				-webkit-user-select: none; /* webkit (safari, chrome) browsers */
				-moz-user-select: none; /* mozilla browsers */
				-khtml-user-select: none; /* webkit (konqueror) browsers */
				-ms-user-select: none; /* IE10+ */
			}

			table.multiselect {
				border-collapse: collapse;
			}

			table.multiselect > thead {
			  background: linear-gradient(#F6F6F6, #E9E9E9, #DCDCDC);
			  border: solid 1px #DCDCDC;
			  cursor: default
			}

			table.multiselect > thead:hover {
			  background: linear-gradient(#E9E9E9, #DCDCDC, #E9E9E9);
			}

			table.multiselect > thead > tr > th {
			  font-weight: normal;
			  padding: 1px;
			}

			table.multiselect > tbody {
			  display: none;
			  background-color: white;
			  border: solid 1px #DCDCDC;
			  position: absolute;
			  z-index: 5;
			}

			table.multiselect > tbody > tr {
			  border: none;
			}

			table.multiselect > tbody > tr > td:first-child:hover {
			  background-color: #DCDCDC;
			}
			 
			table.multiselect > tbody > tr > td:first-child {
			  border-right: solid 1px #DCDCDC; 
			}

			table.multiselect > tbody > tr > td:last-child {
			  border-left:  solid 1px #DCDCDC;
			}

			.floating {
				display: inline-block;
				position: absolute;
				padding-left: 3pt;
				padding-right: 3pt;
				background: #0067FF;
				border-radius: 20%
			}
			
			.floating > #img {
				margin: 3pt;
			}
		</style>
	</head>

	<body>
		<table><tr>
			<td>
				<table id="from" class="multiselect">
					<thead>
						<tr onclick="showCheckboxes(this.parentNode.parentNode)"><th>English</th><th><img src="triangle.png"></th></tr>
					</thead>
					<tbody>
						<tr><td onclick="changeItem(event,this)">Bulgarian</td><td><input type="checkbox" name="ParseBul" checked="true"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Chinese</td><td><input type="checkbox" name="ParseChi"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Dutch</td><td><input type="checkbox" name="ParseDut"/></td></tr>
						<tr><td onclick="changeItem(event,this)">English</td><td><input type="checkbox" name="ParseEng" checked="true"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Estonian</td><td><input type="checkbox" name="ParseEst"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Finnish</td><td><input type="checkbox" name="ParseFin"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Italian</td><td><input type="checkbox" name="ParseIta"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Portuguese</td><td><input type="checkbox" name="ParsePor"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Slovenian</td><td><input type="checkbox" name="ParseSlv"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Spanish</td><td><input type="checkbox" name="ParseSpa"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Swedish</td><td><input type="checkbox" name="ParseSwe" checked="true"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Thai</td><td><input type="checkbox" name="ParseTha"/></td></tr>
						<tr><td onclick="changeItem(event,this)">Turkish</td><td><input type="checkbox" name="ParseTur"/></td></tr>
					</tbody>
				</table>
			</td>
			<td><input id="search" type="text"></td>
			<td><input id="button" type="button" value="Search" onclick="gfwordnet.search(getMultiSelection(element('from')), element('search').value, element('result')); element('search').value = ''"></td>
		</tr></table>

		<br>

		<table class="result" id="result">
		</table>

		<script src="http://cloud.grammaticalframework.org/js/support.js"></script>
		<script src="js/tsnejs.js"></script>
		<script src="js/gfwordnet.js"></script>
		<script src="js/wordcloud2.js"></script>
		<script>
			gfwordnet.initialize()

			element("search").addEventListener("keyup", function(event) {
				event.preventDefault();
				if (event.keyCode === 13) {
					element("button").click();
				}
			});

			function closeCheckboxes(e) {
				var table      = document.getElementById("from");
				var checkboxes = table.getElementsByTagName("TBODY")[0];
				var node = e.target;
				while (node != null) {
					if (node == checkboxes)
						break;
					node = node.parentNode;
				}

				if (node == null) {
					checkboxes.style.display = "none";
					window.removeEventListener("mousedown", closeCheckboxes);
				}
			}

			function showCheckboxes(table) {
			  var checkboxes = table.getElementsByTagName("TBODY")[0];
			  if (checkboxes.style.display == "block") {
				checkboxes.style.display = "none";
				window.removeEventListener("mousedown", closeCheckboxes);
			  } else {
				checkboxes.style.display = "block";
				window.addEventListener("mousedown", closeCheckboxes);
			  }
			}

			function changeItem(e,item) {
				item.parentNode.parentNode.style.display = "none";
				item.parentNode.parentNode.parentNode.firstElementChild.firstElementChild.firstElementChild.innerHTML = item.innerHTML;
				e.stopPropagation();				
			}
			
			function getMultiSelection(table) {
				var current   = table.firstElementChild.firstElementChild.firstElementChild.innerHTML;
				var selection = {current: null, langs: {}, langs_list: []};

				var tr = table.lastElementChild.firstElementChild;
				while (tr != null) {
					var nameElem  = tr.firstElementChild;
					var checkElem = tr.lastElementChild.firstElementChild;

					var name = nameElem.innerHTML;

					if (name == current)
						selection.current = checkElem.name;

					if (checkElem.checked) {
						selection.langs[checkElem.name] = {
							name:  name,
							index: selection.langs_list.length+1
						}
						selection.langs_list.push(checkElem.name);
					}
					tr = tr.nextElementSibling;
				}
				return selection;
			}
		</script>
	</body>
</html>
